# Внедрение СМАРТ-мониторинга (smartupload) у клиентов

В данной главе описан процесс внедрения smartupload на установке у клиента-пользоватея ИСС.
Процесс сей несложный, не требует каких-то специиальных навыков и при "набитой руке" выполняется в среднем минут за 15-20, а то и быстрее.

СМАРТ-мониторинг (smartupload) условно можно разделить на 2 части:
- скрипт smartupload.bat;
- вспомогательная общедоступная бесплатная утилита curl.

Скрипт smartupload.bat предназначен для:
- получения из текущей установки файла SYSINFO;
- сохранения его в заданную для скрипта рабочую папку; 
- загрузку в СМАРТ для последующей обработки. 

Скрипт написан на языке shell cmd. 
Скрипт содержит в себе параметры, обеспечивающие сортировку файлов по дистрибьюторам-пользователям СМАРТа и установкам каждого конкретного дистрибьютора.

Скрипт работает вместе с утилитой Curl. 
Ее назначение - обеспечивать отправку собранного скриптом sysinfo по заданному в скрипте адресу. 
Больше описания утилиты можно найти тут https://ru.wikipedia.org/wiki/CURL или где угодно на просторах Интернета

Весь процесс внедрения условно можно разделить на несколько этапов.
Для удобства навигации оглавление представлено ниже.

Процесс внедрения состоит из следующих этапов:
- Подготовка скрипта smartupload.bat, его размещение
- Скачивание утилиты Curl
- Разворачиваеие утилиты Curl, внедерение скрипта
- Тестовый запуск, оценка результатов запуска
- Автоматизация исполнение скрипта
- Проверка факта загрузки отчета на сервер со СМАРТом

Для целей эффективности и быстроты внедрения специалисту, выполняющему внедрение smartupload желательно быть на уровне Уверенного Пользователя ПК.
Но это не есть обязательно. 
В случае затруднений всегда можно обратиться к разработчику СМАРТа, как в личном чате, так и в общем - https://t.me/joinchat/uRkrNE_SNYY0YTUy .

## Подготовка скрипта smartupload.bat

Скрипт, ввиду его назначения, содержит исходные данные, индивидуальные для каждой конкретной установки, которую следует поставить под контроль СМАРТа.

<img src="img/implementation/smartupload_example.png" alt="Пример скрипта дл внедрения smartupload" align=top>

На скриншоте изображен пример скрипта smartupload.example.bat, который необходимо скорректировать под каждую установку, на которой его надо внедрить.

Как видно из скриншота - есть некоторые данные, которые необходимо поменять, заменив русские буквы на английские:
- АДРЕСПК:ПОРТ - здесь заменить на адрес ПК, на котором развернута установка, подлежащая мониторингу.
Адрес может быть как в виде IP-адреса, так и в виде имени компьютера в сети.

Этот параметр задается и контролируется пользователем СМАРТа.

---

**ВАЖНО!!!** 
Если с течением времени возникла необходимость поменять порт, через который должен будет работать ПК, то после его замены в административной части самого ПК, актуальный порт также необходимо прописать и в этом скрипте вручную.

---

- НАЗВАНИЕКЛИЕНТА - имя клиента для последующей корректной сортировки его обработчиком СМАРТа и успешной идентификации его потом в Grafana на ее таблицах и графиках.

Этот параметр задается и контролируется пользователем СМАРТа.

---

**ВАЖНО!!!** 
Допускает использовать: 
- ТОЛЬКО английские буквы верхнего и нижнего регистра;
- использовать цифры;
- допускается использовать спецсимволы, не противоречащие общим правилам для имен файлов в любой ОС.
- 
Имя должно быть максимально понятным и сходу однозначно трактуемым.
Не выдумывай сложного иначе потом самому будет сложно.

---

- ИМЯДИСТРИБЬЮТОРА - имя твоего предприятия-дистрибьютора, с которым заключен договор на СМАРТ-мониторинг.
Этот параметр задается разработчиком СМАРТа и передается пользователю СМАРТа для внесения в скрипты.

Этот параметр в скриптах служит своего рода меткой, необходимой для корректной сортировки обработчиком СМАРТа.

Параметр задается по маске XXXYYYYYYYY, где:
    - XXX это код дистрибьютора;
    - YYYYYYYYY это краткое, но однозначно трактуемое имя дистрибьютора.

- ТОКЕНБЕЗОПАСНОСТИ - параметр, служащий проверочным ключом при сортировке и валидации поступающих в обработчик СМАРТа отчетов.
Уникален для каждого дистрибьютора.
Един для всех скриптов СМАРТа.
Не подлежит обмену между дистрибьюторами, так как может привести к нарушению процесса проверки и сортировки внутри обработчика СМАРТа.

Этот параметр задается и контролируется разработчиком СМАРТа и передается пользователю СМАРТа для внесения последним этого параметра в скрипты СМАРТа.

Подготовленный скрипт smartupload может находиться где угодно:
- на той же машине (виртуальной или физической), где развернут ПК;
- где-то на локальной сети, в которой доступен ПК.

Для удобства и повышения быстродействия рекомендуется его размещать на той же машине, на которой развернут ПК.
Можно даже в той же директории, где развернут ПК.
Работе самого ПК это НИКАК не помешает.

Для удобства и однозначности восприятия папку с файлами для smartupload рекомендуется так и назвать - smartupload.

НАСТОЯТЕЛЬНО рекомендуется в имени папки для smartupload использовать ТОЛЬКО английские буквы.

Не выдумывай здесь сложного и витиеватого, в этом нет никакой нужды.

## Скачивание утилиты Curl





