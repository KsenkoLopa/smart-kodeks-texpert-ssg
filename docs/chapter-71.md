# Внедрение СМАРТ-мониторинга (smartupload) у клиентов

В данной главе описан процесс внедрения smartupload на установке у клиента-пользоватея ИСС.
Процесс сей несложный, не требует каких-то специальных навыков и при "набитой руке" выполняется в среднем минут за 15-20, а то и быстрее.

СМАРТ-мониторинг (smartupload) условно можно разделить на 2 части:
- скрипт smartupload.bat (для ОС Windows) или smartupload.sh (для ОС Linux);
- вспомогательная общедоступная бесплатная утилита curl.

Скрипт smartupload предназначен для:
- получения из текущей установки файла SYSINFO;
- сохранения его в заданную для скрипта рабочую папку; 
- загрузку в СМАРТ для последующей обработки. 

Скрипт написан на языке shell cmd. 
Скрипт содержит в себе параметры, обеспечивающие сортировку файлов по дистрибьюторам-пользователям СМАРТа и установкам каждого конкретного дистрибьютора.

Скрипт работает вместе с утилитой Curl. 
Ее назначение - обеспечивать отправку собранного скриптом sysinfo по заданному в скрипте адресу. 
Больше описания утилиты можно найти тут https://ru.wikipedia.org/wiki/CURL или где угодно на просторах Интернета.

Весь процесс внедрения условно можно разделить на несколько этапов.
Для удобства навигации оглавление представлено ниже.

Процесс внедрения состоит из следующих этапов:
- Подготовка скрипта smartupload, его размещение
- Скачивание утилиты Curl
- Разворачиваеие утилиты Curl, внедерение скрипта
- Тестовый запуск, оценка результатов запуска
- Автоматизация исполнение скрипта
- Проверка факта загрузки отчета на сервер со СМАРТом

Для целей эффективности и быстроты внедрения специалисту, выполняющему внедрение smartupload желательно быть на уровне Уверенного Пользователя ПК (для ОС Windows).

В случае затруднений всегда можно обратиться к разработчику СМАРТа, как в личном чате, так и в общем - https://t.me/joinchat/uRkrNE_SNYY0YTUy .

## Подготовка скрипта smartupload

Скрипт, ввиду его назначения, содержит исходные данные, индивидуальные для каждой конкретной установки, которую следует поставить под контроль СМАРТа.

<img src="img/implementation/smartupload_example.png" alt="Пример скрипта дл внедрения smartupload" align=top>

На скриншоте изображен пример скрипта smartupload.example.bat, который необходимо скорректировать под каждую установку, на которой его надо внедрить.

Как видно из скриншота - есть некоторые данные, которые необходимо поменять, заменив русские буквы на английские:
- АДРЕСПК:ПОРТ - здесь заменить на адрес ПК, на котором развернута установка, подлежащая мониторингу.
Адрес может быть как в виде IP-адреса, так и в виде имени компьютера в сети.

Этот параметр задается и контролируется пользователем СМАРТа.

Если с течением времени возникла необходимость поменять порт, через который должен будет работать ПК, то после его замены в административной части самого ПК, актуальный порт также необходимо прописать и в этом скрипте вручную.

- НАЗВАНИЕКЛИЕНТА - имя клиента для последующей корректной сортировки его обработчиком СМАРТа и успешной идентификации его потом в Grafana на ее таблицах и графиках.

Этот параметр задается и контролируется пользователем СМАРТа.

Допускает использовать: 
- ТОЛЬКО английские буквы верхнего и нижнего регистра;
- использовать цифры;
- допускается использовать спецсимволы, не противоречащие общим правилам для имен файлов в любой ОС.

<img src="img/implementation/symbols_names.png" alt="Недопустимые символы в имени файла или каталога" align=top>

Имя должно быть максимально понятным и сходу однозначно трактуемым.
Не выдумывай сложного иначе потом самому будет сложно.

- ИМЯДИСТРИБЬЮТОРА - имя твоего предприятия-дистрибьютора, с которым заключен договор на СМАРТ-мониторинг.
Этот параметр задается разработчиком СМАРТа и передается пользователю СМАРТа для внесения в скрипты.

Этот параметр в скриптах служит своего рода меткой, необходимой для корректной сортировки всех приходящих отчетов обработчиком СМАРТа.

Параметр задается по маске XXXYYYYYYYY, где:
    - XXX это код дистрибьютора;
    - YYYYYYYYY это краткое, но однозначно трактуемое имя дистрибьютора.

- ТОКЕНБЕЗОПАСНОСТИ - параметр, служащий проверочным ключом при сортировке и валидации поступающих в обработчик СМАРТа отчетов.
Уникален для каждого дистрибьютора.
Един для всех скриптов СМАРТа.
Не подлежит обмену между дистрибьюторами, так как может привести к нарушению процесса проверки и сортировки приходящих отчетов внутри обработчика СМАРТа.

Этот параметр задается и контролируется разработчиком СМАРТа и передается пользователю СМАРТа для внесения последним этого параметра в скрипты СМАРТа.

Подготовленный скрипт smartupload может находиться:
- на той же машине (виртуальной или физической), где развернут ПК;
- где-то на локальной сети, в которой доступен ПК.

---

**ВАЖНО!!!** Настоятельно не рекомендуется размещать smartupload в ОС, отличающейся от ОС, в которой развернут контролируемый СМАРТом ПК.
Скрипты по своей структуре различаются в зависимости от того, в какой среде они должны исполняться, равно как и ПК дистрибутивами и архитектурой точно также различаются.

Не усложняй. Размещай подобное в подобном.

---

Для удобства и повышения быстродействия рекомендуется его размещать на той же машине, на которой развернут ПК.
Можно даже в той же директории, где развернут ПК.
Работе самого ПК это НИКАК не помешает.

Для удобства и однозначности восприятия папку с файлами для smartupload рекомендуется так и назвать - smartupload.

НАСТОЯТЕЛЬНО рекомендуется в имени каталога для smartupload использовать ТОЛЬКО английские буквы.

Не выдумывай здесь сложного и витиеватого, в этом нет никакой нужды.

## Скачивание утилиты Curl

Вторая часть smartupload это утилита curl.
Ее назначение - отправлять собранный smartupload отчет sysinfo по заданному маршруту.

Утилита бесплатная и относится к категории свободного ПО.

Скачать ее можно с ее официального ресурса: https://curl.se/download.html

На странице представлены архивы и приложения для установки практически по всем известным или менее известным операционным средам, существующим на данный момент.

Для целей внедрения утилиты curl рядом с smartupload необходимо скачать АРХИВ утилиты, подходящей под твою операционную среду.

Для удобства поиска желаемого архива используй Crtl+F, для поиска по ключевым словам на странице сайта.




